angular.module("myApp").directive("footer",function(){return{restrict:"A",replace:!0,templateUrl:"/resources/app/footer/footer.html",controller:"FooterController",controllerAs:"footer"}}),angular.module("myApp").controller("FooterController",["$scope","$mdToast","BrowserFactory",function(t,e,a){a.version();t.closeToast=function(){e.hide()}}]),angular.module("myApp").directive("upload",function(){return{restrict:"A",replace:!0,templateUrl:"/resources/app/upload/upload.html",controller:"UploadController"}}),angular.module("myApp").controller("UploadController",["$scope","$rootScope","$timeout","Upload","growl","uploadService","$mdDialog","UtilsFactory","StorageFactory",function(t,e,a,o,n,l,r,i,c){t.loading=!1,t.isLogin=c.get("isLogin"),e.$on("LocalStorageModule.notification.setitem",function(e,a){"isLogin"===a.key&&(t.isLogin=c.get("isLogin"),t.isLogin&&t.file&&t.upload(t.file))}),t.percentage=0,t.uploadFiles=function(t,e){},t.checkLogin=function(e){t.file=e,t.isLogin||r.show({controller:"SigninController",templateUrl:"/resources/app/signin/signin.html",parent:angular.element(document.body),clickOutsideToClose:!0})},t.upload=function(e){e&&t.isLogin&&(e.$error||(t.loading=!0,l.digestFile(e).then(function(a){t.success({hash:a,file:e})})))},t.success=function(e){t.loading=!1,r.show({locals:{data:e},controller:"TransactionCreateController",templateUrl:"/resources/app/transaction/transactionCreate.html",parent:angular.element(document.body),clickOutsideToClose:!0})},t.$on("createTransactionLoading",function(e,a){t.loading=a})}]),angular.module("myApp").service("uploadService",["$http","UtilsFactory",function(t,e){this.digestFile=function(t){if(t)return new Promise(function(a,o){var n=new FileReader;n.readAsBinaryString(t),n.onload=function(t){var o;o=t?t.target.result:n.content;var l=e.SHA256(o);a(l)},n.onerror=function(t){o("There was an error in reading file, please check the file and try again.")}})}}]),angular.module("myApp").directive("validateUpload",function(){return{restrict:"A",replace:!0,templateUrl:"/resources/app/upload/validateUpload.html",controller:"ValidateUploadController"}}),angular.module("myApp").controller("ValidateUploadController",["$scope","$timeout","Upload","growl","uploadService","$mdDialog","UtilsFactory","$translate","BrowserFactory",function(t,e,a,o,n,l,r,i,c){t.loading=!1,t.percentage=0,t.validateUpload=function(e){if(e&&!e.$error){t.loading=!0;c.version();n.digestFile(e).then(function(e){t.validate({hash:e})})}},t.validate=function(e){r.HttpPost("/validateTnxBydataHash",{dataHash:e.hash}).then(function(e){t.loading=!1,e.data?(e.data.isTrxMine=!1,e.data.dataComplete=!0,l.show({locals:{data:e.data},controller:"TransactionSummaryController",templateUrl:"/resources/app/transaction/transactionSummary.html",parent:angular.element(document.body),clickOutsideToClose:!0})):l.show({controller:"ValidateUploadController",templateUrl:"/resources/app/transaction/invalidAlert.html",parent:angular.element(document.body),clickOutsideToClose:!0})}).catch(function(e){t.loading=!1,l.show({templateUrl:"/resources/app/transaction/invalidAlert.html",parent:angular.element(document.body),clickOutsideToClose:!0})})},t.cancel=function(){t.loading=!1,l.hide("cancel")}}]),angular.module("myApp").controller("PaymentController",["$scope","$location","$mdDialog","$mdToast","UtilsFactory","StorageFactory","UserFactory","$translate",function(t,e,a,o,n,l,r,i){t.msg={},t.loading=!1,t.paymentData={ubit:20,rials:0,exchangeRate:0},function(){n.HttpPost("/getExchangeRate",{}).then(function(e){t.paymentData.exchangeRate=e.data,t.paymentData.rials=t.paymentData.exchangeRate*t.paymentData.ubit*10}).catch(function(e){t.paymentData.exchangeRate=0}),t.$watch("paymentData.ubit",function(){t.paymentData.rials=t.paymentData.exchangeRate*t.paymentData.ubit*10})}(),t.submit=function(){t.msg={},t.loading=!0;var a=l.get("token"),o=e.protocol()+"://"+e.host()+":"+e.port()+"/buyCredit?token="+a+"&ubit="+t.paymentData.ubit;window.open(o)},t.cancel=function(){a.hide("cancel")}}]),angular.module("myApp").controller("PaymentResultController",["$scope","data","$mdDialog","$mdToast","UtilsFactory","StorageFactory","UserFactory","$translate",function(t,e,a,o,n,l,r,i){t.msg=e}]);